!function(t,i){"function"==typeof define&&define.amd?define(["d3"],function(e){return t.Rickshaw=i(e)}):"object"==typeof exports?module.exports=i(require("d3")):t.Rickshaw=i(d3)}(this,function(w){var o={version:"1.6.6",namespace:function(e,t){for(var i=e.split("."),n=o,r=1,s=i.length;r<s;r++){var a=i[r];n[a]=n[a]||{},n=n[a]}return n},keys:function(e){var t=[];for(var i in e)t.push(i);return t},extend:function(e,t){for(var i in t)e[i]=t[i];return e},clone:function(e){return JSON.parse(JSON.stringify(e))}};return function(e){var t=Object.prototype.toString,n="Null",r="Undefined",s="Boolean",a="Number",h="String",o="Object",i="[object Function]";function d(e){return t.call(e)===i}function u(e){if(function(e){switch(e){case null:return n;case void 0:return r}switch(typeof e){case"boolean":return s;case"number":return a;case"string":return h}return o}(e)!==o)throw new TypeError;var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t}var c=Array.prototype.slice;function f(e,t){var i=e;return function(){var e=l([p(i,this)],arguments);return t.apply(this,e)}}function l(e,t){for(var i=e.length,n=t.length;n--;)e[i+n]=t[n];return e}function p(e,n){if(arguments.length<2&&void 0===e)return this;var r=e,s=c.call(arguments,2);return function(){var e,t,i=(e=s,t=arguments,l(e=c.call(e,0),t));return r.apply(n,i)}}var m=function(){},g=function(){var l=function(){for(var e in{toString:1})if("toString"===e)return!1;return!0}();function s(){}return{create:function(){var e=null,t=[].slice.apply(arguments);function i(){this.initialize.apply(this,arguments)}if(d(t[0])&&(e=t.shift()),function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}(i,g.Methods),i.superclass=e,i.subclasses=[],e){s.prototype=e.prototype,i.prototype=new s;try{e.subclasses.push(i)}catch(e){}}for(var n=0,r=t.length;n<r;n++)i.addMethods(t[n]);return i.prototype.initialize||(i.prototype.initialize=m),i.prototype.constructor=i},Methods:{addMethods:function(e){var t,i,n=this.superclass&&this.superclass.prototype,r=u(e);l&&(e.toString!=Object.prototype.toString&&r.push("toString"),e.valueOf!=Object.prototype.valueOf&&r.push("valueOf"));for(var s=0,a=r.length;s<a;s++){var h=r[s],o=e[h];if(n&&d(o)&&"$super"==(t=o,i=t.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(","),1!=i.length||i[0]?i:[])[0]){var c=o;(o=f(function(e){return function(){return n[e].apply(this,arguments)}}(h),c)).valueOf=p(c.valueOf,c),o.toString=p(c.toString,c)}this.prototype[h]=o}return this}}}}();e.exports?e.exports.Class=g:e.Class=g}(o),o.namespace("Rickshaw.Compat.ClassList"),o.Compat.ClassList=function(){"undefined"==typeof document||"classList"in document.createElement("a")||function(e){"use strict";var t="classList",i="prototype",n=(e.HTMLElement||e.Element)[i],r=Object,s=String[i].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[i].indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===e)return t;return-1},h=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},o=function(e,t){if(""===t)throw new h("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new h("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(e,t)},c=function(e){for(var t=s.call(e.className),i=t?t.split(/\s+/):[],n=0,r=i.length;n<r;n++)this.push(i[n]);this._updateClassName=function(){e.className=this.toString()}},l=c[i]=[],d=function(){return new c(this)};if(h[i]=Error[i],l.item=function(e){return this[e]||null},l.contains=function(e){return-1!==o(this,e+="")},l.add=function(e){-1===o(this,e+="")&&(this.push(e),this._updateClassName())},l.remove=function(e){var t=o(this,e+="");-1!==t&&(this.splice(t,1),this._updateClassName())},l.toggle=function(e){-1===o(this,e+="")?this.add(e):this.remove(e)},l.toString=function(){return this.join(" ")},r.defineProperty){var u={get:d,enumerable:!0,configurable:!0};try{r.defineProperty(n,t,u)}catch(e){-2146823252===e.number&&(u.enumerable=!1,r.defineProperty(n,t,u))}}else r[i].__defineGetter__&&n.__defineGetter__(t,d)}(window)},("undefined"!=typeof RICKSHAW_NO_COMPAT&&!RICKSHAW_NO_COMPAT||"undefined"==typeof RICKSHAW_NO_COMPAT)&&new o.Compat.ClassList,o.namespace("Rickshaw.Graph"),o.Graph=function(e){var s=this;this.initialize=function(e){if(!e.element)throw"Rickshaw.Graph needs a reference to an element";if(1!==e.element.nodeType)throw"Rickshaw.Graph element was defined but not an HTML element";this.element=e.element,this.series=e.series,this.window={},this.updateCallbacks=[],this.configureCallbacks=[],this.defaults={interpolation:"cardinal",offset:"zero",min:void 0,max:void 0,preserve:!1,xScale:void 0,yScale:void 0,stack:!0},this._loadRenderers(),this.configure(e),this.setSeries(e.series),this.setSize({width:e.width,height:e.height}),this.element.classList.add("rickshaw_graph"),this.vis=w.select(this.element).append("svg:svg").attr("width",this.width).attr("height",this.height),this.discoverRange()},this._loadRenderers=function(){for(var e in o.Graph.Renderer)if(e&&o.Graph.Renderer.hasOwnProperty(e)){var t=o.Graph.Renderer[e];t&&t.prototype&&t.prototype.render&&s.registerRenderer(new t({graph:s}))}},this.validateSeries=function(e){if(!(Array.isArray(e)||e instanceof o.Series))throw"series is not an array: "+Object.prototype.toString.apply(e);e.forEach(function(e){if(!(e instanceof Object))throw"series element is not an object: "+e;if(!e.data)throw"series has no data: "+JSON.stringify(e);if(!Array.isArray(e.data))throw"series data is not an array: "+JSON.stringify(e.data);if(0<e.data.length){var t=e.data[0].x,i=e.data[0].y;if("number"!=typeof t||"number"!=typeof i&&null!==i)throw"x and y properties of points should be numbers instead of "+typeof t+" and "+typeof i}if(3<=e.data.length&&(e.data[2].x<e.data[1].x||e.data[1].x<e.data[0].x||e.data[e.data.length-1].x<e.data[0].x))throw"series data needs to be sorted on x values for series name: "+e.name},this)},this.setSeries=function(e){this.validateSeries(e),this.series=e,this.series.active=function(){return s.series.filter(function(e){return!e.disabled})}},this.dataDomain=function(){var e=this.series.map(function(e){return e.data});return[w.min(e.map(function(e){return e[0].x})),w.max(e.map(function(e){return e[e.length-1].x}))]},this.discoverRange=function(){var e=this.renderer.domain();this.x=(this.xScale||w.scale.linear()).copy().domain(e.x).range([0,this.width]),this.y=(this.yScale||w.scale.linear()).copy().domain(e.y).range([this.height,0]),this.x.magnitude=w.scale.linear().domain([e.x[0]-e.x[0],e.x[1]-e.x[0]]).range([0,this.width]),this.y.magnitude=w.scale.linear().domain([e.y[0]-e.y[0],e.y[1]-e.y[0]]).range([0,this.height])},this.render=function(){this.stackData();this.discoverRange(),this.renderer.render(),this.updateCallbacks.forEach(function(e){e()})},this.update=this.render,this.stackData=function(){var t,n=this.series.active().map(function(e){return e.data}).map(function(e){return e.filter(function(e){return this._slice(e)},this)},this),i=this.preserve;if(i||this.series.forEach(function(e){e.scale&&(i=!0)}),n=i?o.clone(n):n,this.series.active().forEach(function(t,e){if(t.scale){var i=n[e];i&&i.forEach(function(e){e.y=t.scale(e.y)})}}),this.stackData.hooks.data.forEach(function(e){n=e.f.apply(s,[n])}),!this.renderer.unstack){this._validateStackable();var e=w.layout.stack();e.offset(s.offset),t=e(n)}t=t||n,this.renderer.unstack&&t.forEach(function(e){e.forEach(function(e){e.y0=void 0===e.y0?0:e.y0})}),this.stackData.hooks.after.forEach(function(e){t=e.f.apply(s,[n])});var r=0;return this.series.forEach(function(e){e.disabled||(e.stack=t[r++])}),this.stackedData=t},this._validateStackable=function(){var t;this.series.forEach(function(e){if((t=t||e.data.length)&&e.data.length!=t)throw"stacked series cannot have differing numbers of points: "+t+" vs "+e.data.length+"; see Rickshaw.Series.fill()"},this)},this.stackData.hooks={data:[],after:[]},this._slice=function(e){if(this.window.xMin||this.window.xMax){var t=!0;return this.window.xMin&&e.x<this.window.xMin&&(t=!1),this.window.xMax&&e.x>this.window.xMax&&(t=!1),t}return!0},this.onUpdate=function(e){this.updateCallbacks.push(e)},this.onConfigure=function(e){this.configureCallbacks.push(e)},this.registerRenderer=function(e){this._renderers=this._renderers||{},this._renderers[e.name]=e},this.configure=function(t){this.config=this.config||{},(t.width||t.height)&&this.setSize(t),o.keys(this.defaults).forEach(function(e){this.config[e]=e in t?t[e]:e in this?this[e]:this.defaults[e]},this),o.keys(this.config).forEach(function(e){this[e]=this.config[e]},this),"stack"in t&&(t.unstack=!t.stack);var e=t.renderer||this.renderer&&this.renderer.name||"stack";this.setRenderer(e,t),this.configureCallbacks.forEach(function(e){e(t)})},this.setRenderer=function(e,t){if("function"==typeof e)this.renderer=new e({graph:s}),this.registerRenderer(this.renderer);else{if(!this._renderers[e])throw"couldn't find renderer "+e;this.renderer=this._renderers[e]}"object"==typeof t&&this.renderer.configure(t)},this.setSize=function(e){if((e=e||{}).width&&e.height)this.width=e.width,this.height=e.height;else{if("undefined"!=typeof window)var t=window.getComputedStyle(this.element,null),i=parseInt(t.getPropertyValue("width"),10),n=parseInt(t.getPropertyValue("height"),10);this.width=e.width||i||400,this.height=e.height||n||250}this.vis&&this.vis.attr("width",this.width).attr("height",this.height)},this.initialize(e)},o.namespace("Rickshaw.Fixtures.Color"),o.Fixtures.Color=function(){this.schemes={},this.schemes.spectrum14=["#ecb796","#dc8f70","#b2a470","#92875a","#716c49","#d2ed82","#bbe468","#a1d05d","#e7cbe6","#d8aad6","#a888c2","#9dc2d3","#649eb9","#387aa3"].reverse(),this.schemes.spectrum2000=["#57306f","#514c76","#646583","#738394","#6b9c7d","#84b665","#a7ca50","#bfe746","#e2f528","#fff726","#ecdd00","#d4b11d","#de8800","#de4800","#c91515","#9a0000","#7b0429","#580839","#31082b"],this.schemes.spectrum2001=["#2f243f","#3c2c55","#4a3768","#565270","#6b6b7c","#72957f","#86ad6e","#a1bc5e","#b8d954","#d3e04e","#ccad2a","#cc8412","#c1521d","#ad3821","#8a1010","#681717","#531e1e","#3d1818","#320a1b"],this.schemes.classic9=["#423d4f","#4a6860","#848f39","#a2b73c","#ddcb53","#c5a32f","#7d5836","#963b20","#7c2626","#491d37","#2f254a"].reverse(),this.schemes.httpStatus={503:"#ea5029",502:"#d23f14",500:"#bf3613",410:"#efacea",409:"#e291dc",403:"#f457e8",408:"#e121d2",401:"#b92dae",405:"#f47ceb",404:"#a82a9f",400:"#b263c6",301:"#6fa024",302:"#87c32b",307:"#a0d84c",304:"#28b55c",200:"#1a4f74",206:"#27839f",201:"#52adc9",202:"#7c979f",203:"#a5b8bd",204:"#c1cdd1"},this.schemes.colorwheel=["#b5b6a9","#858772","#785f43","#96557e","#4682b4","#65b9ac","#73c03a","#cb513a"].reverse(),this.schemes.cool=["#5e9d2f","#73c03a","#4682b4","#7bc3b8","#a9884e","#c1b266","#a47493","#c09fb5"],this.schemes.munin=["#00cc00","#0066b3","#ff8000","#ffcc00","#330099","#990099","#ccff00","#ff0000","#808080","#008f00","#00487d","#b35a00","#b38f00","#6b006b","#8fb300","#b30000","#bebebe","#80ff80","#80c9ff","#ffc080","#ffe680","#aa80ff","#ee00cc","#ff8080","#666600","#ffbfff","#00ffcc","#cc6699","#999900"]},o.namespace("Rickshaw.Fixtures.RandomData"),o.Fixtures.RandomData=function(a){a=a||1;var t=200,h=Math.floor((new Date).getTime()/1e3);this.addData=function(e){var n=100*Math.random()+15+t,r=e[0].length,s=1;e.forEach(function(e){var t=20*Math.random(),i=n/25+s+++15*(Math.cos(r*s*11/960)+2)+7*(Math.cos(r/7)+2)+1*(Math.cos(r/17)+2);e.push({x:r*a+h,y:i+t})}),t=.85*n},this.removeData=function(e){e.forEach(function(e){e.shift()}),h+=a}},o.namespace("Rickshaw.Fixtures.Time"),o.Fixtures.Time=function(){var t=this;this.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.units=[{name:"decade",seconds:315576e3,formatter:function(e){return 10*parseInt(e.getUTCFullYear()/10,10)}},{name:"year",seconds:31557600,formatter:function(e){return e.getUTCFullYear()}},{name:"month",seconds:2635200,formatter:function(e){return t.months[e.getUTCMonth()]}},{name:"week",seconds:604800,formatter:function(e){return t.formatDate(e)}},{name:"day",seconds:86400,formatter:function(e){return e.getUTCDate()}},{name:"6 hour",seconds:21600,formatter:function(e){return t.formatTime(e)}},{name:"hour",seconds:3600,formatter:function(e){return t.formatTime(e)}},{name:"15 minute",seconds:900,formatter:function(e){return t.formatTime(e)}},{name:"minute",seconds:60,formatter:function(e){return e.getUTCMinutes()+"m"}},{name:"15 second",seconds:15,formatter:function(e){return e.getUTCSeconds()+"s"}},{name:"second",seconds:1,formatter:function(e){return e.getUTCSeconds()+"s"}},{name:"decisecond",seconds:.1,formatter:function(e){return e.getUTCMilliseconds()+"ms"}},{name:"centisecond",seconds:.01,formatter:function(e){return e.getUTCMilliseconds()+"ms"}}],this.unit=function(t){return this.units.filter(function(e){return t==e.name}).shift()},this.formatDate=function(e){return w.time.format("%b %e")(e)},this.formatTime=function(e){return e.toUTCString().match(/(\d+:\d+):/)[1]},this.ceil=function(e,t){var i,n;if("month"!=t.name)return"year"==t.name?(i=new Date(1e3*e),Date.UTC(i.getUTCFullYear(),0)/1e3==e?e:(n=i.getUTCFullYear()+1,Date.UTC(n,0)/1e3)):Math.ceil(e/t.seconds)*t.seconds;if(i=new Date(1e3*e),Date.UTC(i.getUTCFullYear(),i.getUTCMonth())/1e3==e)return e;n=i.getUTCFullYear();var r=i.getUTCMonth();return 11==r?(r=0,n+=1):r+=1,Date.UTC(n,r)/1e3}},o.namespace("Rickshaw.Fixtures.Time.Local"),o.Fixtures.Time.Local=function(){var t=this;this.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.units=[{name:"decade",seconds:315576e3,formatter:function(e){return 10*parseInt(e.getFullYear()/10,10)}},{name:"year",seconds:31557600,formatter:function(e){return e.getFullYear()}},{name:"month",seconds:2635200,formatter:function(e){return t.months[e.getMonth()]}},{name:"week",seconds:604800,formatter:function(e){return t.formatDate(e)}},{name:"day",seconds:86400,formatter:function(e){return e.getDate()}},{name:"6 hour",seconds:21600,formatter:function(e){return t.formatTime(e)}},{name:"hour",seconds:3600,formatter:function(e){return t.formatTime(e)}},{name:"15 minute",seconds:900,formatter:function(e){return t.formatTime(e)}},{name:"minute",seconds:60,formatter:function(e){return e.getMinutes()}},{name:"15 second",seconds:15,formatter:function(e){return e.getSeconds()+"s"}},{name:"second",seconds:1,formatter:function(e){return e.getSeconds()+"s"}},{name:"decisecond",seconds:.1,formatter:function(e){return e.getMilliseconds()+"ms"}},{name:"centisecond",seconds:.01,formatter:function(e){return e.getMilliseconds()+"ms"}}],this.unit=function(t){return this.units.filter(function(e){return t==e.name}).shift()},this.formatDate=function(e){return w.time.format("%b %e")(e)},this.formatTime=function(e){return e.toString().match(/(\d+:\d+):/)[1]},this.ceil=function(e,t){var i,n,r;if("day"==t.name){var s=new Date(1e3*(e+t.seconds-1)),a=new Date(0);return a.setFullYear(s.getFullYear()),a.setMonth(s.getMonth()),a.setDate(s.getDate()),a.setMilliseconds(0),a.setSeconds(0),a.setMinutes(0),a.setHours(0),a.getTime()/1e3}if("month"!=t.name)return"year"==t.name?(i=new Date(1e3*e),new Date(i.getUTCFullYear(),0).getTime()/1e3==e?e:(n=i.getFullYear()+1,new Date(n,0).getTime()/1e3)):(r=60*new Date(1e3*e).getTimezoneOffset(),Math.ceil((e-r)/t.seconds)*t.seconds+r);if(i=new Date(1e3*e),new Date(i.getFullYear(),i.getMonth()).getTime()/1e3==e)return e;n=i.getFullYear();var h=i.getMonth();return 11==h?(h=0,n+=1):h+=1,new Date(n,h).getTime()/1e3}},o.namespace("Rickshaw.Fixtures.Number"),o.Fixtures.Number.formatKMBT=function(e){var t=Math.abs(e);return 1e12<=t?e/1e12+"T":1e9<=t?e/1e9+"B":1e6<=t?e/1e6+"M":1e3<=t?e/1e3+"K":t<1&&0<t?e.toFixed(2):0===t?"":e},o.Fixtures.Number.formatBase1024KMGTP=function(e){var t=Math.abs(e);return 0x4000000000000<=t?e/0x4000000000000+"P":1099511627776<=t?e/1099511627776+"T":1073741824<=t?e/1073741824+"G":1048576<=t?e/1048576+"M":1024<=t?e/1024+"K":t<1&&0<t?e.toFixed(2):0===t?"":e},o.namespace("Rickshaw.Color.Palette"),o.Color.Palette=function(e){var t=new o.Fixtures.Color;if(e=e||{},this.schemes={},this.scheme=t.schemes[e.scheme]||e.scheme||t.schemes.colorwheel,this.runningIndex=0,this.generatorIndex=0,e.interpolatedStopCount){var i,n,r=this.scheme.length-1,s=[];for(i=0;i<r;i++){s.push(this.scheme[i]);var a=w.interpolateHsl(this.scheme[i],this.scheme[i+1]);for(n=1;n<e.interpolatedStopCount;n++)s.push(a(1/e.interpolatedStopCount*n))}s.push(this.scheme[this.scheme.length-1]),this.scheme=s}this.rotateCount=this.scheme.length,this.color=function(e){return this.scheme[e]||this.scheme[this.runningIndex++]||this.interpolateColor()||"#808080"},this.interpolateColor=function(){var e;if(Array.isArray(this.scheme))return this.generatorIndex==2*this.rotateCount-1?(e=w.interpolateHsl(this.scheme[this.generatorIndex],this.scheme[0])(.5),this.generatorIndex=0,this.rotateCount*=2):(e=w.interpolateHsl(this.scheme[this.generatorIndex],this.scheme[this.generatorIndex+1])(.5),this.generatorIndex++),this.scheme.push(e),e}},o.namespace("Rickshaw.Graph.Ajax"),o.Graph.Ajax=o.Class.create({initialize:function(e){this.dataURL=e.dataURL,this.onData=e.onData||function(e){return e},this.onComplete=e.onComplete||function(){},this.onError=e.onError||function(){},this.args=e,this.request()},request:function(){jQuery.ajax({url:this.dataURL,dataType:"json",success:this.success.bind(this),error:this.error.bind(this)})},error:function(){console.log("error loading dataURL: "+this.dataURL),this.onError(this)},success:function(e,t){e=this.onData(e),this.args.series=this._splice({data:e,series:this.args.series}),this.graph=this.graph||new o.Graph(this.args),this.graph.render(),this.onComplete(this)},_splice:function(e){var t=e.data,i=e.series;return e.series?(i.forEach(function(i){var n=i.key||i.name;if(!n)throw"series needs a key or a name";t.forEach(function(t){var e=t.key||t.name;if(!e)throw"data needs a key or a name";if(n==e){["color","name","data"].forEach(function(e){t[e]&&(i[e]=t[e])})}})}),i):t}}),o.namespace("Rickshaw.Graph.Annotate"),o.Graph.Annotate=function(e){this.graph=e.graph;this.elements={timeline:e.element};var h=this;this.data={},this.elements.timeline.classList.add("rickshaw_annotation_timeline"),this.add=function(e,t,i){h.data[e]=h.data[e]||{boxes:[]},h.data[e].boxes.push({content:t,end:i})},this.update=function(){o.keys(h.data).forEach(function(e){var s=h.data[e],a=h.graph.x(e);if(a<0||a>h.graph.x.range()[1])return s.element&&(s.line.classList.add("offscreen"),s.element.style.display="none"),void s.boxes.forEach(function(e){e.rangeElement&&e.rangeElement.classList.add("offscreen")});if(!s.element){var t=s.element=document.createElement("div");t.classList.add("annotation"),this.elements.timeline.appendChild(t),t.addEventListener("click",function(e){t.classList.toggle("active"),s.line.classList.toggle("active"),s.boxes.forEach(function(e){e.rangeElement&&e.rangeElement.classList.toggle("active")})},!1)}s.element.style.left=a+"px",s.element.style.display="block",s.boxes.forEach(function(e){var t=e.element;if(t||((t=e.element=document.createElement("div")).classList.add("content"),t.innerHTML=e.content,s.element.appendChild(t),s.line=document.createElement("div"),s.line.classList.add("annotation_line"),h.graph.element.appendChild(s.line),e.end&&(e.rangeElement=document.createElement("div"),e.rangeElement.classList.add("annotation_range"),h.graph.element.appendChild(e.rangeElement))),e.end){var i=a,n=Math.min(h.graph.x(e.end),h.graph.x.range()[1]);n<i&&(n=a,i=Math.max(h.graph.x(e.end),h.graph.x.range()[0]));var r=n-i;e.rangeElement.style.left=i+"px",e.rangeElement.style.width=r+"px",e.rangeElement.classList.remove("offscreen")}s.line.classList.remove("offscreen"),s.line.style.left=a+"px"})},this)},this.graph.onUpdate(function(){h.update()})},o.namespace("Rickshaw.Graph.Axis.Time"),o.Graph.Axis.Time=function(e){var n=this;this.graph=e.graph,this.elements=[],this.ticksTreatment=e.ticksTreatment||"plain",this.fixedTimeUnit=e.timeUnit;var h=e.timeFixture||new o.Fixtures.Time;this.appropriateTimeUnit=function(){var t,e=h.units,i=this.graph.x.domain(),n=i[1]-i[0];return e.forEach(function(e){2<=Math.floor(n/e.seconds)&&(t=t||e)}),t||h.units[h.units.length-1]},this.tickOffsets=function(){for(var e=this.graph.x.domain(),t=this.fixedTimeUnit||this.appropriateTimeUnit(),i=Math.ceil((e[1]-e[0])/t.seconds),n=e[0],r=[],s=0;s<i;s++){var a=h.ceil(n,t);n=a+t.seconds/2,r.push({value:a,unit:t})}return r},this.render=function(){this.elements.forEach(function(e){e.parentNode.removeChild(e)}),this.elements=[],this.tickOffsets().forEach(function(e){if(!(n.graph.x(e.value)>n.graph.x.range()[1])){var t=document.createElement("div");t.style.left=n.graph.x(e.value)+"px",t.classList.add("x_tick"),t.classList.add(n.ticksTreatment);var i=document.createElement("div");i.classList.add("title"),i.innerHTML=e.unit.formatter(new Date(1e3*e.value)),t.appendChild(i),n.graph.element.appendChild(t),n.elements.push(t)}})},this.graph.onUpdate(function(){n.render()})},o.namespace("Rickshaw.Graph.Axis.X"),o.Graph.Axis.X=function(s){var t=this;this.initialize=function(e){this.graph=e.graph,this.orientation=e.orientation||"top",this.pixelsPerTick=e.pixelsPerTick||75,e.ticks&&(this.staticTicks=e.ticks),e.tickValues&&(this.tickValues=e.tickValues),this.tickSize=e.tickSize||4,this.ticksTreatment=e.ticksTreatment||"plain",e.element?(this.element=e.element,this._discoverSize(e.element,e),this.vis=w.select(e.element).append("svg:svg").attr("height",this.height).attr("width",this.width).attr("class","rickshaw_graph x_axis_d3"),this.element=this.vis[0][0],this.element.style.position="relative",this.setSize({width:e.width,height:e.height})):this.vis=this.graph.vis,this.graph.onUpdate(function(){t.render()})},this.setSize=function(e){if(e=e||{},this.element){this._discoverSize(this.element.parentNode,e),this.vis.attr("height",this.height).attr("width",1.1*this.width);var t=Math.floor(.1*this.width/2);this.element.style.left=-1*t+"px"}},this.render=function(){void 0!==this._renderWidth&&this.graph.width!==this._renderWidth&&this.setSize({auto:!0});var e=w.svg.axis().scale(this.graph.x).orient(this.orientation);e.tickFormat(s.tickFormat||function(e){return e}),this.tickValues&&e.tickValues(this.tickValues),this.ticks=this.staticTicks||Math.floor(this.graph.width/this.pixelsPerTick);var t,i=Math.floor(.1*this.width/2)||0,n="bar"==this.graph.renderer.name&&Math.ceil(.95*this.graph.width/this.graph.series[0].data.length/2)||0;"top"==this.orientation?t="translate("+(i+n)+","+(this.height||this.graph.height)+")":t="translate("+(i+n)+", 0)";this.element&&this.vis.selectAll("*").remove(),this.vis.append("svg:g").attr("class",["x_ticks_d3",this.ticksTreatment].join(" ")).attr("transform",t).call(e.ticks(this.ticks).tickSubdivide(0).tickSize(this.tickSize));var r=("bottom"==this.orientation?1:-1)*this.graph.height;this.graph.vis.append("svg:g").attr("class","x_grid_d3").call(e.ticks(this.ticks).tickSubdivide(0).tickSize(r)).selectAll("text").each(function(){this.parentNode.setAttribute("data-x-value",this.textContent)}),this._renderHeight=this.graph.height},this._discoverSize=function(e,t){if("undefined"!=typeof window){var i=window.getComputedStyle(e,null),n=parseInt(i.getPropertyValue("height"),10);if(!t.auto)var r=parseInt(i.getPropertyValue("width"),10)}this.width=1.1*(t.width||r||this.graph.width),this.height=t.height||n||40},this.initialize(s)},o.namespace("Rickshaw.Graph.Axis.Y"),o.Graph.Axis.Y=o.Class.create({initialize:function(e){this.graph=e.graph,this.orientation=e.orientation||"right",this.pixelsPerTick=e.pixelsPerTick||75,e.ticks&&(this.staticTicks=e.ticks),e.tickValues&&(this.tickValues=e.tickValues),this.tickSize=e.tickSize||4,this.ticksTreatment=e.ticksTreatment||"plain",this.tickFormat=e.tickFormat||function(e){return e},this.berthRate=.1,e.element?(this.element=e.element,this.vis=w.select(e.element).append("svg:svg").attr("class","rickshaw_graph y_axis"),this.element=this.vis[0][0],this.element.style.position="relative",this.setSize({width:e.width,height:e.height})):this.vis=this.graph.vis;var t=this;this.graph.onUpdate(function(){t.render()})},setSize:function(e){if(e=e||{},this.element){if("undefined"!=typeof window){var t=window.getComputedStyle(this.element.parentNode,null),i=parseInt(t.getPropertyValue("width"),10);if(!e.auto)var n=parseInt(t.getPropertyValue("height"),10)}this.width=e.width||i||this.graph.width*this.berthRate,this.height=e.height||n||this.graph.height,this.vis.attr("width",this.width).attr("height",this.height*(1+this.berthRate));var r=this.height*this.berthRate;"left"==this.orientation&&(this.element.style.top=-1*r+"px")}},render:function(){void 0!==this._renderHeight&&this.graph.height!==this._renderHeight&&this.setSize({auto:!0}),this.ticks=this.staticTicks||Math.floor(this.graph.height/this.pixelsPerTick);var e=this._drawAxis(this.graph.y);this._drawGrid(e),this._renderHeight=this.graph.height},_drawAxis:function(e){var t=w.svg.axis().scale(e).orient(this.orientation);if(t.tickFormat(this.tickFormat),this.tickValues&&t.tickValues(this.tickValues),"left"==this.orientation)var i=this.height*this.berthRate,n="translate("+this.width+", "+i+")";return this.element&&this.vis.selectAll("*").remove(),this.vis.append("svg:g").attr("class",["y_ticks",this.ticksTreatment].join(" ")).attr("transform",n).call(t.ticks(this.ticks).tickSubdivide(0).tickSize(this.tickSize)),t},_drawGrid:function(e){var t=("right"==this.orientation?1:-1)*this.graph.width;this.graph.vis.append("svg:g").attr("class","y_grid").call(e.ticks(this.ticks).tickSubdivide(0).tickSize(t)).selectAll("text").each(function(){this.parentNode.setAttribute("data-y-value",this.textContent)})}}),o.namespace("Rickshaw.Graph.Axis.Y.Scaled"),o.Graph.Axis.Y.Scaled=o.Class.create(o.Graph.Axis.Y,{initialize:function($super,e){if(void 0===e.scale)throw new Error("Scaled requires scale");this.scale=e.scale,void 0===e.grid?this.grid=!0:this.grid=e.grid,$super(e)},_drawAxis:function($super,e){var t=this.scale.domain(),i=this.graph.renderer.domain().y,n=[Math.min.apply(Math,t),Math.max.apply(Math,t)],r=w.scale.linear().domain([0,1]).range(n),s=[r(i[0]),r(i[1])],a=w.scale.linear().domain(n).range(s);return $super(this.scale.copy().domain(t.map(a)).range(e.range()))},_drawGrid:function($super,e){this.grid&&$super(e)}}),o.namespace("Rickshaw.Graph.Behavior.Series.Highlight"),o.Graph.Behavior.Series.Highlight=function(e){this.graph=e.graph,this.legend=e.legend;var r=this,s={},t=null,a=e.disabledColor||function(e){return w.interpolateRgb(e,w.rgb("#d8d8d8"))(.8).toString()};this.addHighlightEvents=function(n){n.element.addEventListener("mouseover",function(e){t||(t=n,r.legend.lines.forEach(function(e){if(n!==e)s[e.series.name]=s[e.series.name]||e.series.color,e.series.color=a(e.series.color);else if(r.graph.renderer.unstack&&(!e.series.renderer||e.series.renderer.unstack)){var t=r.graph.series.indexOf(e.series);e.originalIndex=t;var i=r.graph.series.splice(t,1)[0];r.graph.series.push(i)}}),r.graph.update())},!1),n.element.addEventListener("mouseout",function(e){t&&(t=null,r.legend.lines.forEach(function(e){if(n===e&&e.hasOwnProperty("originalIndex")){var t=r.graph.series.pop();r.graph.series.splice(e.originalIndex,0,t),delete e.originalIndex}s[e.series.name]&&(e.series.color=s[e.series.name])}),r.graph.update())},!1)},this.legend&&this.legend.lines.forEach(function(e){r.addHighlightEvents(e)})},o.namespace("Rickshaw.Graph.Behavior.Series.Order"),o.Graph.Behavior.Series.Order=function(e){this.graph=e.graph,this.legend=e.legend;var r=this;if(void 0===window.jQuery)throw"couldn't find jQuery at window.jQuery";if(void 0===window.jQuery.ui)throw"couldn't find jQuery UI at window.jQuery.ui";jQuery(function(){jQuery(r.legend.list).sortable({containment:"parent",tolerance:"pointer",update:function(e,t){var i=[];jQuery(r.legend.list).find("li").each(function(e,t){t.series&&i.push(t.series)});for(var n=r.graph.series.length-1;0<=n;n--)r.graph.series[n]=i.shift();r.graph.update()}}),jQuery(r.legend.list).disableSelection()}),this.graph.onUpdate(function(){var e=window.getComputedStyle(r.legend.element).height;r.legend.element.style.height=e})},o.namespace("Rickshaw.Graph.Behavior.Series.Toggle"),o.Graph.Behavior.Series.Toggle=function(e){this.graph=e.graph,this.legend=e.legend;var s=this;this.addAnchor=function(r){var e=document.createElement("a");e.innerHTML="&#10004;",e.classList.add("action"),r.element.insertBefore(e,r.element.firstChild),e.onclick=function(e){if(r.series.disabled)r.series.enable(),r.element.classList.remove("disabled");else{if(this.graph.series.filter(function(e){return!e.disabled}).length<=1)return;r.series.disable(),r.element.classList.add("disabled")}s.graph.update()}.bind(this),r.element.getElementsByTagName("span")[0].onclick=function(e){var t=r.series.disabled;if(!t)for(var i=0;i<s.legend.lines.length;i++){var n=s.legend.lines[i];if(r.series===n.series);else if(!n.series.disabled){t=!0;break}}t?(r.series.enable(),r.element.classList.remove("disabled"),s.legend.lines.forEach(function(e){r.series===e.series||(e.series.disable(),e.element.classList.add("disabled"))})):s.legend.lines.forEach(function(e){e.series.enable(),e.element.classList.remove("disabled")}),s.graph.update()}},this.legend&&("undefined"!=typeof jQuery&&jQuery(this.legend.list).sortable&&jQuery(this.legend.list).sortable({start:function(e,t){t.item.bind("no.onclick",function(e){e.preventDefault()})},stop:function(e,t){setTimeout(function(){t.item.unbind("no.onclick")},250)}}),this.legend.lines.forEach(function(e){s.addAnchor(e)})),this._addBehavior=function(){this.graph.series.forEach(function(e){e.disable=function(){if(s.graph.series.length<=1)throw"only one series left";e.disabled=!0},e.enable=function(){e.disabled=!1}})},this._addBehavior(),this.updateBehaviour=function(){this._addBehavior()}},o.namespace("Rickshaw.Graph.DragZoom"),o.Graph.DragZoom=o.Class.create({initialize:function(e){if(!e||!e.graph)throw new Error("Rickshaw.Graph.DragZoom needs a reference to a graph");var t={opacity:.5,fill:"steelblue",minimumTimeSelection:60,callback:function(){}};this.graph=e.graph,this.svg=w.select(this.graph.element).select("svg"),this.svgWidth=parseInt(this.svg.attr("width"),10),this.opacity=e.opacity||t.opacity,this.fill=e.fill||t.fill,this.minimumTimeSelection=e.minimumTimeSelection||t.minimumTimeSelection,this.callback=e.callback||t.callback,this.registerMouseEvents()},registerMouseEvents:function(){var n,s=this,t=27,a={startDt:null,stopDt:null,startPX:null,stopPX:null};function i(e,t){a.stopDt=c(w.event);var i=[a.startDt,a.stopDt].sort(o);s.graph.window.xMin=i[0],s.graph.window.xMax=i[1];var n=s.graph.window.xMax,r=s.graph.window.xMax-s.graph.window.xMin;h(this),r<s.minimumTimeSelection||isNaN(r)||(s.graph.update(),s.callback({range:r,endTime:n}))}function r(){var e=a.stopPX=w.event.offsetX||w.event.layerX;if(!(e>s.svgWidth-1||e<1)){var t=[a.startPX,e].sort(o),i=t[1]-t[0];if(isNaN(i))return h(this);n.attr("fill",s.fill).attr("x",t[0]).attr("width",i)}}function h(e){w.select(e).on("mousemove",null),w.select(document).on("mouseup",null),a={},n.remove()}function o(e,t){return e-t}function c(e){return Math.floor(s.graph.x.invert(e.offsetX||e.layerX))}this.svg.on("mousedown",function(){var e=w.select(this);n=e.append("rect").style("opacity",s.opacity).attr("y",0).attr("height","100%"),w.event.preventDefault?w.event.preventDefault():w.event.returnValue=!1;a.target=w.event.target,a.startDt=c(w.event),a.startPX=w.event.offsetX||w.event.layerX,e.on("mousemove",r),w.select(document).on("mouseup",i),w.select(document).on("keyup",function(){w.event.keyCode===t&&h(this)})})}}),o.namespace("Rickshaw.Graph.HoverDetail"),o.Graph.HoverDetail=o.Class.create({initialize:function(e){var t=this.graph=e.graph;this.xFormatter=e.xFormatter||function(e){return new Date(1e3*e).toUTCString()},this.yFormatter=e.yFormatter||function(e){return null===e?e:e.toFixed(2)};var i=this.element=document.createElement("div");i.className="detail inactive",this.visible=!0,t.element.appendChild(i),this.lastEvent=null,this._addListeners(),this.onShow=e.onShow,this.onHide=e.onHide,this.onRender=e.onRender,this.formatter=e.formatter||this.formatter},formatter:function(e,t,i,n,r,s){return e.name+":&nbsp;"+r},update:function(e){if((e=e||this.lastEvent)&&(this.lastEvent=e).target.nodeName.match(/^(path|svg|rect|circle)$/)){var u,f=this.graph,t=f.element.getBoundingClientRect(),p=e.clientX-t.left,m=e.clientY-t.top,g=0,v=[];if(this.graph.series.active().forEach(function(e){var t=this.graph.stackedData[g++];if(t.length){var i=f.x.invert(p),n=w.scale.linear().domain([t[0].x,t.slice(-1)[0].x]).range([0,t.length-1]),r=Math.round(n(i));r==t.length-1&&r--;for(var s=Math.min(r||0,t.length-1),a=r;a<t.length-1&&(t[a]&&t[a+1]);){if(t[a].x<=i&&t[a+1].x>i){s=Math.abs(i-t[a].x)<Math.abs(i-t[a+1].x)?a:a+1;break}t[a+1].x<=i?a++:a--}s<0&&(s=0);var h=t[s],o=Math.sqrt(Math.pow(Math.abs(f.x(h.x)-p),2)+Math.pow(Math.abs(f.y(h.y+h.y0)-m),2)),c=e.xFormatter||this.xFormatter,l=e.yFormatter||this.yFormatter,d={formattedXValue:c(h.x),formattedYValue:l(e.scale?e.scale.invert(h.y):h.y),series:e,value:h,distance:o,order:g,name:e.name};(!u||o<u.distance)&&(u=d),v.push(d)}},this),u){u.active=!0;var i=u.value.x,n=u.formattedXValue;this.element.innerHTML="",this.element.style.left=f.x(i)+"px",this.visible&&this.render({points:v,detail:v,mouseX:p,mouseY:m,formattedXValue:n,domainX:i})}}},hide:function(){this.visible=!1,this.element.classList.add("inactive"),"function"==typeof this.onHide&&this.onHide()},show:function(){this.visible=!0,this.element.classList.remove("inactive"),"function"==typeof this.onShow&&this.onShow()},render:function(e){var t=this.graph,i=e.points.filter(function(e){return e.active}).shift();if(null!==i.value.y){var n=i.formattedXValue,r=i.formattedYValue;this.element.innerHTML="",this.element.style.left=t.x(i.value.x)+"px";var s=document.createElement("div");s.className="x_label",s.innerHTML=n,this.element.appendChild(s);var a=document.createElement("div");a.className="item";var h=i.series,o=h.scale?h.scale.invert(i.value.y):i.value.y;a.innerHTML=this.formatter(h,i.value.x,o,n,r,i),a.style.top=this.graph.y(i.value.y0+i.value.y)+"px",this.element.appendChild(a);var c=document.createElement("div");c.className="dot",c.style.top=a.style.top,c.style.borderColor=h.color,this.element.appendChild(c),i.active&&(a.classList.add("active"),c.classList.add("active"));var l=[s,a];l.forEach(function(e){e.classList.add("left")}),this.show();var d=this._calcLayoutError(l);if(0<d)l.forEach(function(e){e.classList.remove("left"),e.classList.add("right")}),d<this._calcLayoutError(l)&&l.forEach(function(e){e.classList.remove("right"),e.classList.add("left")});"function"==typeof this.onRender&&this.onRender(e)}},_calcLayoutError:function(e){var i=this.element.parentNode.getBoundingClientRect(),n=0;e.forEach(function(e){var t=e.getBoundingClientRect();t.width&&(t.right>i.right&&(n+=t.right-i.right),t.left<i.left&&(n+=i.left-t.left))});return n},_addListeners:function(){this.mousemoveListener=function(e){this.visible=!0,this.update(e)}.bind(this),this.graph.element.addEventListener("mousemove",this.mousemoveListener,!1),this.graph.onUpdate(function(){this.update()}.bind(this)),this.mouseoutListener=function(e){!e.relatedTarget||e.relatedTarget.compareDocumentPosition(this.graph.element)&Node.DOCUMENT_POSITION_CONTAINS||this.hide()}.bind(this),this.graph.element.addEventListener("mouseout",this.mouseoutListener,!1)},_removeListeners:function(){this.mousemoveListener&&this.graph.element.removeEventListener("mousemove",this.mousemoveListener,!1),this.mouseoutListener&&this.graph.element.removeEventListener("mouseout",this.mouseoutListener,!1)}}),o.namespace("Rickshaw.Graph.JSONP"),o.Graph.JSONP=o.Class.create(o.Graph.Ajax,{request:function(){jQuery.ajax({url:this.dataURL,dataType:"jsonp",success:this.success.bind(this),error:this.error.bind(this)})}}),o.namespace("Rickshaw.Graph.Legend"),o.Graph.Legend=o.Class.create({className:"rickshaw_legend",initialize:function(e){this.element=e.element,this.graph=e.graph,this.naturalOrder=e.naturalOrder,this.element.classList.add(this.className),this.list=document.createElement("ul"),this.element.appendChild(this.list),this.render(),this.graph.onUpdate(function(){})},render:function(){for(var t=this;this.list.firstChild;)this.list.removeChild(this.list.firstChild);this.lines=[];var e=this.graph.series.map(function(e){return e});this.naturalOrder||(e=e.reverse()),e.forEach(function(e){t.addLine(e)})},addLine:function(e){var t=document.createElement("li");t.className="line",e.disabled&&(t.className+=" disabled"),e.className&&w.select(t).classed(e.className,!0);var i=document.createElement("div");i.className="swatch",i.style.backgroundColor=e.color,t.appendChild(i);var n=document.createElement("span");n.className="label",n.innerHTML=e.name,t.appendChild(n),this.list.appendChild(t),(t.series=e).noLegend&&(t.style.display="none");var r={element:t,series:e};return this.shelving&&(this.shelving.addAnchor(r),this.shelving.updateBehaviour()),this.highlighter&&this.highlighter.addHighlightEvents(r),this.lines.push(r),t}}),o.namespace("Rickshaw.Graph.RangeSlider"),o.Graph.RangeSlider=o.Class.create({initialize:function(e){var t=jQuery,i=this,n=(this.element=e.element,this.graphs=e.graphs);n||(n=this.graph=e.graph),n.constructor!==Array&&(n=[n]),this.graph=n[0],this.slideCallbacks=[],this.build();for(var r=0;r<n.length;r++)n[r].onUpdate(function(){i.update()}.bind(i)),function(e){n[e].onConfigure(function(){t(this.element)[0].style.width=n[e].width+"px"}.bind(i))}(r)},build:function(){var e,t=this.element,i=jQuery,n=this,r=this.graphs||this.graph;r.constructor!==Array&&(r=[r]),this.graph=r[0],e=r[0].dataDomain(),i(function(){i(t).slider({range:!0,min:e[0],max:e[1],values:[e[0],e[1]],start:function(e,t){n.slideStarted({event:e,ui:t})},stop:function(e,t){n.slideFinished({event:e,ui:t})},slide:function(e,t){if(n.slideShouldUpdate(e,t)&&!(t.values[1]<=t.values[0]))for(var i=0;i<r.length;i++)n.processSlideChange({event:e,ui:t,graph:r[i]})}})}),r[0].onConfigure(function(){i(this.element)[0].style.width=r[0].width+"px"}.bind(this))},update:function(){var e=this.element,t=this.graph,i=jQuery,n=i(e).slider("option","values"),r=t.dataDomain();i(e).slider("option","min",r[0]),i(e).slider("option","max",r[1]),null==t.window.xMin&&(n[0]=r[0]),null==t.window.xMax&&(n[1]=r[1]),i(e).slider("option","values",n)},onSlide:function(e){this.slideCallbacks.push(e)},processSlideChange:function(e){e.event;var t=e.ui,i=e.graph;i.window.xMin=t.values[0],i.window.xMax=t.values[1],i.update();var n=i.dataDomain();n[0]==t.values[0]&&(i.window.xMin=void 0),n[1]==t.values[1]&&(i.window.xMax=void 0),this.slideCallbacks.forEach(function(e){e(i,i.window.xMin,i.window.xMax)})},slideShouldUpdate:function(){return!0},slideStarted:function(){},slideFinished:function(){}}),o.namespace("Rickshaw.Graph.RangeSlider.Preview"),o.Graph.RangeSlider.Preview=o.Class.create({initialize:function(e){if(!e.element)throw"Rickshaw.Graph.RangeSlider.Preview needs a reference to an element";if(!e.graph&&!e.graphs)throw"Rickshaw.Graph.RangeSlider.Preview needs a reference to an graph or an array of graphs";this.element=e.element,this.element.style.position="relative",this.graphs=e.graph?[e.graph]:e.graphs,this.defaults={height:75,width:400,gripperColor:void 0,frameTopThickness:3,frameHandleThickness:10,frameColor:"#d4d4d4",frameOpacity:1,minimumFrameWidth:0,heightRatio:.2},this.heightRatio=e.heightRatio||this.defaults.heightRatio,this.defaults.gripperColor=w.rgb(this.defaults.frameColor).darker().toString(),this.configureCallbacks=[],this.slideCallbacks=[],this.previews=[],e.width||(this.widthFromGraph=!0),e.height||(this.heightFromGraph=!0),(this.widthFromGraph||this.heightFromGraph)&&this.graphs[0].onConfigure(function(){this.configure(e),this.render()}.bind(this)),e.width=e.width||this.graphs[0].width||this.defaults.width,e.height=e.height||this.graphs[0].height*this.heightRatio||this.defaults.height,this.configure(e),this.render()},onSlide:function(e){this.slideCallbacks.push(e)},onConfigure:function(e){this.configureCallbacks.push(e)},configure:function(t){this.config=this.config||{},this.configureCallbacks.forEach(function(e){e(t)}),o.keys(this.defaults).forEach(function(e){this.config[e]=e in t?t[e]:e in this.config?this.config[e]:this.defaults[e]},this),("width"in t||"height"in t)&&(this.widthFromGraph&&(this.config.width=this.graphs[0].width),this.heightFromGraph&&(this.config.height=this.graphs[0].height*this.heightRatio,this.previewHeight=this.config.height),this.previews.forEach(function(e){var t=this.previewHeight/this.graphs.length-2*this.config.frameTopThickness,i=this.config.width-2*this.config.frameHandleThickness;if(e.setSize({width:i,height:t}),this.svg){var n=t+2*this.config.frameHandleThickness,r=i+2*this.config.frameHandleThickness;this.svg.style("width",r+"px"),this.svg.style("height",n+"px")}},this))},render:function(){var a=this;this.svg=w.select(this.element).selectAll("svg.rickshaw_range_slider_preview").data([null]),this.previewHeight=this.config.height-2*this.config.frameTopThickness,this.previewWidth=this.config.width-2*this.config.frameHandleThickness,this.currentFrame=[0,this.previewWidth];var e=w.select(this.element).selectAll("div.rickshaw_range_slider_preview_container").data(this.graphs),t="translate("+this.config.frameHandleThickness+"px, "+this.config.frameTopThickness+"px)";e.enter().append("div").classed("rickshaw_range_slider_preview_container",!0).style("-webkit-transform",t).style("-moz-transform",t).style("-ms-transform",t).style("transform",t).each(function(e,t){var i=o.extend({},e.config),n=a.previewHeight/a.graphs.length,r=e.renderer.name;o.extend(i,{element:this.appendChild(document.createElement("div")),height:n,width:a.previewWidth,series:e.series,renderer:r});var s=new o.Graph(i);a.previews.push(s),e.onUpdate(function(){s.render(),a.render()}),e.onConfigure(function(e){delete e.height,e.width=e.width-2*a.config.frameHandleThickness,s.configure(e),s.render()}),s.render()}),e.exit().remove();var i=this.graphs[0],n=w.scale.linear().domain([0,this.previewWidth]).range(i.dataDomain()),r=[i.window.xMin,i.window.xMax];this.currentFrame[0]=void 0===r[0]?0:Math.round(n.invert(r[0])),this.currentFrame[0]<0&&(this.currentFrame[0]=0),this.currentFrame[1]=void 0===r[1]?this.previewWidth:n.invert(r[1]),this.currentFrame[1]-this.currentFrame[0]<a.config.minimumFrameWidth&&(this.currentFrame[1]=(this.currentFrame[0]||0)+a.config.minimumFrameWidth),this.svg.enter().append("svg").classed("rickshaw_range_slider_preview",!0).style("height",this.config.height+"px").style("width",this.config.width+"px").style("position","absolute").style("top",0),this._renderDimming(),this._renderFrame(),this._renderGrippers(),this._renderHandles(),this._renderMiddle(),this._registerMouseEvents()},_renderDimming:function(){var e=this.svg.selectAll("path.dimming").data([null]);e.enter().append("path").attr("fill","white").attr("fill-opacity","0.7").attr("fill-rule","evenodd").classed("dimming",!0);var t="";t+=" M "+this.config.frameHandleThickness+" "+this.config.frameTopThickness,t+=" h "+this.previewWidth,t+=" v "+this.previewHeight,t+=" h "+-this.previewWidth,t+=" z ",t+=" M "+Math.max(this.currentFrame[0],this.config.frameHandleThickness)+" "+this.config.frameTopThickness,t+=" H "+Math.min(this.currentFrame[1]+2*this.config.frameHandleThickness,this.previewWidth+this.config.frameHandleThickness),t+=" v "+this.previewHeight,t+=" H "+Math.max(this.currentFrame[0],this.config.frameHandleThickness),t+=" z",e.attr("d",t)},_renderFrame:function(){var e=this.svg.selectAll("path.frame").data([null]);e.enter().append("path").attr("stroke","white").attr("stroke-width","1px").attr("stroke-linejoin","round").attr("fill",this.config.frameColor).attr("fill-opacity",this.config.frameOpacity).attr("fill-rule","evenodd").classed("frame",!0);var t="";t+=" M "+this.currentFrame[0]+" 0",t+=" H "+(this.currentFrame[1]+2*this.config.frameHandleThickness),t+=" V "+this.config.height,t+=" H "+this.currentFrame[0],t+=" z",t+=" M "+(this.currentFrame[0]+this.config.frameHandleThickness)+" "+this.config.frameTopThickness,t+=" H "+(this.currentFrame[1]+this.config.frameHandleThickness),t+=" v "+this.previewHeight,t+=" H "+(this.currentFrame[0]+this.config.frameHandleThickness),t+=" z",e.attr("d",t)},_renderGrippers:function(){var e=this.svg.selectAll("path.gripper").data([null]);e.enter().append("path").attr("stroke",this.config.gripperColor).classed("gripper",!0);var t="";[.4,.6].forEach(function(e){t+=" M "+Math.round(this.currentFrame[0]+this.config.frameHandleThickness*e)+" "+Math.round(.3*this.config.height),t+=" V "+Math.round(.7*this.config.height),t+=" M "+Math.round(this.currentFrame[1]+this.config.frameHandleThickness*(1+e))+" "+Math.round(.3*this.config.height),t+=" V "+Math.round(.7*this.config.height)}.bind(this)),e.attr("d",t)},_renderHandles:function(){var e=this.svg.selectAll("rect.left_handle").data([null]);e.enter().append("rect").attr("width",this.config.frameHandleThickness).style("cursor","ew-resize").style("fill-opacity","0").classed("left_handle",!0),e.attr("x",this.currentFrame[0]).attr("height",this.config.height);var t=this.svg.selectAll("rect.right_handle").data([null]);t.enter().append("rect").attr("width",this.config.frameHandleThickness).style("cursor","ew-resize").style("fill-opacity","0").classed("right_handle",!0),t.attr("x",this.currentFrame[1]+this.config.frameHandleThickness).attr("height",this.config.height)},_renderMiddle:function(){var e=this.svg.selectAll("rect.middle_handle").data([null]);e.enter().append("rect").style("cursor","move").style("fill-opacity","0").classed("middle_handle",!0),e.attr("width",Math.max(0,this.currentFrame[1]-this.currentFrame[0])).attr("x",this.currentFrame[0]+this.config.frameHandleThickness).attr("height",this.config.height)},_registerMouseEvents:function(){var e=w.select(this.element),s={target:null,start:null,stop:null,left:!1,right:!1,rigid:!1},a=this;function t(e,t){s.stop=a._getClientXFromEvent(w.event,s);var i=s.stop-s.start,n=a.frameBeforeDrag.slice(0),r=a.config.minimumFrameWidth;s.rigid&&(r=a.frameBeforeDrag[1]-a.frameBeforeDrag[0]),s.left&&(n[0]=Math.max(n[0]+i,0)),s.right&&(n[1]=Math.min(n[1]+i,a.previewWidth)),n[1]-n[0]<=r&&(s.left&&(n[0]=n[1]-r),s.right&&(n[1]=n[0]+r),n[0]<=0&&(n[1]-=n[0],n[0]=0),n[1]>=a.previewWidth&&(n[0]-=n[1]-a.previewWidth,n[1]=a.previewWidth)),a.graphs.forEach(function(t){var e=w.scale.linear().interpolate(w.interpolateNumber).domain([0,a.previewWidth]).range(t.dataDomain()),i=[e(n[0]),e(n[1])];a.slideCallbacks.forEach(function(e){e(t,i[0],i[1])}),0===n[0]&&(i[0]=void 0),n[1]===a.previewWidth&&(i[1]=void 0),t.window.xMin=i[0],t.window.xMax=i[1],t.update()})}function i(){s.target=w.event.target,s.start=a._getClientXFromEvent(w.event,s),a.frameBeforeDrag=a.currentFrame.slice(),w.event.preventDefault?w.event.preventDefault():w.event.returnValue=!1,w.select(document).on("mousemove.rickshaw_range_slider_preview",t),w.select(document).on("mouseup.rickshaw_range_slider_preview",o),w.select(document).on("touchmove.rickshaw_range_slider_preview",t),w.select(document).on("touchend.rickshaw_range_slider_preview",o),w.select(document).on("touchcancel.rickshaw_range_slider_preview",o)}function n(e,t){s.left=!0,i()}function r(e,t){s.right=!0,i()}function h(e,t){s.left=!0,s.right=!0,s.rigid=!0,i()}function o(e,t){w.select(document).on("mousemove.rickshaw_range_slider_preview",null),w.select(document).on("mouseup.rickshaw_range_slider_preview",null),w.select(document).on("touchmove.rickshaw_range_slider_preview",null),w.select(document).on("touchend.rickshaw_range_slider_preview",null),w.select(document).on("touchcancel.rickshaw_range_slider_preview",null),delete a.frameBeforeDrag,s.left=!1,s.right=!1,s.rigid=!1}e.select("rect.left_handle").on("mousedown",n),e.select("rect.right_handle").on("mousedown",r),e.select("rect.middle_handle").on("mousedown",h),e.select("rect.left_handle").on("touchstart",n),e.select("rect.right_handle").on("touchstart",r),e.select("rect.middle_handle").on("touchstart",h)},_getClientXFromEvent:function(e,t){switch(e.type){case"touchstart":case"touchmove":for(var i=e.changedTouches,n=null,r=0;r<i.length;r++)if(i[r].target===t.target){n=i[r];break}return null!==n?n.clientX:void 0;default:return e.clientX}}}),o.namespace("Rickshaw.Graph.Renderer"),o.Graph.Renderer=o.Class.create({initialize:function(e){this.graph=e.graph,this.tension=e.tension||this.tension,this.configure(e)},seriesPathFactory:function(){},seriesStrokeFactory:function(){},defaults:function(){return{tension:.8,strokeWidth:2,unstack:!0,padding:{top:.01,right:0,bottom:.01,left:0},stroke:!1,fill:!1,opacity:1}},domain:function(e){var t=e||this.graph.stackedData||this.graph.stackData();t=t.filter(function(e){return e&&0!==e.length});var i=1/0,n=-1/0,r=1/0,s=-1/0;return t.forEach(function(e){e.forEach(function(e){if(null!=e.y){var t=e.y+e.y0;t<r&&(r=t),s<t&&(s=t)}}),e.length&&(e[0].x<i&&(i=e[0].x),e[e.length-1].x>n&&(n=e[e.length-1].x))}),i-=(n-i)*this.padding.left,n+=(n-i)*this.padding.right,r="auto"===this.graph.min?r:this.graph.min||0,s=void 0===this.graph.max?s:this.graph.max,("auto"===this.graph.min||r<0)&&(r-=(s-r)*this.padding.bottom),void 0===this.graph.max&&(s+=(s-r)*this.padding.top),{x:[i,n],y:[r,s]}},render:function(e){e=e||{};var t=this.graph,i=e.series||t.series,n=e.vis||t.vis;n.selectAll("*").remove();var r=i.filter(function(e){return!e.disabled}).map(function(e){return e.stack}),s=n.selectAll("path.path").data(r).enter().append("svg:path").classed("path",!0).attr("d",this.seriesPathFactory());if(this.stroke)var a=n.selectAll("path.stroke").data(r).enter().append("svg:path").classed("stroke",!0).attr("d",this.seriesStrokeFactory());var h=0;i.forEach(function(e){e.disabled||(e.path=s[0][h],this.stroke&&(e.stroke=a[0][h]),this._styleSeries(e),h++)},this)},_styleSeries:function(e){var t=this.fill?e.color:"none",i=this.stroke?e.color:"none",n=e.strokeWidth?e.strokeWidth:this.strokeWidth,r=e.opacity?e.opacity:this.opacity;e.path.setAttribute("fill",t),e.path.setAttribute("stroke",i),e.path.setAttribute("stroke-width",n),e.path.setAttribute("opacity",r),e.className&&w.select(e.path).classed(e.className,!0),e.className&&this.stroke&&w.select(e.stroke).classed(e.className,!0)},configure:function(i){i=i||{},o.keys(this.defaults()).forEach(function(t){i.hasOwnProperty(t)?"object"==typeof this.defaults()[t]?o.keys(this.defaults()[t]).forEach(function(e){this[t][e]=void 0!==i[t][e]?i[t][e]:void 0!==this[t][e]?this[t][e]:this.defaults()[t][e]},this):this[t]=void 0!==i[t]?i[t]:void 0!==this[t]?this[t]:void 0!==this.graph[t]?this.graph[t]:this.defaults()[t]:this[t]=this[t]||this.graph[t]||this.defaults()[t]},this)},setStrokeWidth:function(e){void 0!==e&&(this.strokeWidth=e)},setTension:function(e){void 0!==e&&(this.tension=e)}}),o.namespace("Rickshaw.Graph.Renderer.Line"),o.Graph.Renderer.Line=o.Class.create(o.Graph.Renderer,{name:"line",defaults:function($super){return o.extend($super(),{unstack:!0,fill:!1,stroke:!0})},seriesPathFactory:function(){var t=this.graph,e=w.svg.line().x(function(e){return t.x(e.x)}).y(function(e){return t.y(e.y)}).interpolate(this.graph.interpolation).tension(this.tension);return e.defined&&e.defined(function(e){return null!==e.y}),e}}),o.namespace("Rickshaw.Graph.Renderer.Stack"),o.Graph.Renderer.Stack=o.Class.create(o.Graph.Renderer,{name:"stack",defaults:function($super){return o.extend($super(),{fill:!0,stroke:!1,unstack:!1})},seriesPathFactory:function(){var t=this.graph,e=w.svg.area().x(function(e){return t.x(e.x)}).y0(function(e){return t.y(e.y0)}).y1(function(e){return t.y(e.y+e.y0)}).interpolate(this.graph.interpolation).tension(this.tension);return e.defined&&e.defined(function(e){return null!==e.y}),e}}),o.namespace("Rickshaw.Graph.Renderer.Bar"),o.Graph.Renderer.Bar=o.Class.create(o.Graph.Renderer,{name:"bar",defaults:function($super){var e=o.extend($super(),{gapSize:.05,unstack:!1,opacity:1});return delete e.tension,e},initialize:function($super,e){e=e||{},this.gapSize=e.gapSize||this.gapSize,$super(e)},domain:function($super){var e=$super(),t=this._frequentInterval(this.graph.stackedData.slice(-1).shift());return e.x[1]+=Number(t.magnitude),e},barWidth:function(e){var t=this._frequentInterval(e.stack);return this.graph.x.magnitude(t.magnitude)*(1-this.gapSize)},render:function(e){e=e||{};var i=this.graph,t=e.series||i.series,n=e.vis||i.vis;n.selectAll("*").remove();var r=this.barWidth(t.active()[0]),s=0,a=t.filter(function(e){return!e.disabled}).length,h=this.unstack?r/a:r,o=function(e){return"matrix("+[1,0,0,e.y<0?-1:1,0,e.y<0?2*i.y.magnitude(Math.abs(e.y)):0].join(",")+")"};t.forEach(function(t){if(!t.disabled){this.barWidth(t);var e=n.selectAll("path").data(t.stack.filter(function(e){return null!==e.y})).enter().append("svg:rect").attr("x",function(e){return i.x(e.x)+s}).attr("y",function(e){return i.y(e.y0+Math.abs(e.y))*(e.y<0?-1:1)}).attr("width",h).attr("height",function(e){return i.y.magnitude(Math.abs(e.y))}).attr("opacity",t.opacity).attr("transform",o);Array.prototype.forEach.call(e[0],function(e){e.setAttribute("fill",t.color)}),this.unstack&&(s+=h)}},this)},_frequentInterval:function(e){for(var t={},i=0;i<e.length-1;i++){var n=e[i+1].x-e[i].x;t[n]=t[n]||0,t[n]++}var r={count:0,magnitude:1};return o.keys(t).sort(function(e,t){return Number(e)-Number(t)}).forEach(function(e){r.count<t[e]&&(r={count:t[e],magnitude:e})}),r}}),o.namespace("Rickshaw.Graph.Renderer.Area"),o.Graph.Renderer.Area=o.Class.create(o.Graph.Renderer,{name:"area",defaults:function($super){return o.extend($super(),{unstack:!1,fill:!1,stroke:!1})},seriesPathFactory:function(){var t=this.graph,e=w.svg.area().x(function(e){return t.x(e.x)}).y0(function(e){return t.y(e.y0)}).y1(function(e){return t.y(e.y+e.y0)}).interpolate(t.interpolation).tension(this.tension);return e.defined&&e.defined(function(e){return null!==e.y}),e},seriesStrokeFactory:function(){var t=this.graph,e=w.svg.line().x(function(e){return t.x(e.x)}).y(function(e){return t.y(e.y+e.y0)}).interpolate(t.interpolation).tension(this.tension);return e.defined&&e.defined(function(e){return null!==e.y}),e},render:function(e){e=e||{};var t=this.graph,i=e.series||t.series,n=e.vis||t.vis;n.selectAll("*").remove();var r=this.unstack?"append":"insert",s=i.filter(function(e){return!e.disabled}).map(function(e){return e.stack}),a=n.selectAll("path").data(s).enter()[r]("svg:g","g");a.append("svg:path").attr("d",this.seriesPathFactory()).attr("class","area"),this.stroke&&a.append("svg:path").attr("d",this.seriesStrokeFactory()).attr("class","line");var h=0;i.forEach(function(e){e.disabled||(e.path=a[0][h++],this._styleSeries(e))},this)},_styleSeries:function(e){e.path&&(w.select(e.path).select(".area").attr("fill",e.color),this.stroke&&w.select(e.path).select(".line").attr("fill","none").attr("stroke",e.stroke||w.interpolateRgb(e.color,"black")(.125)).attr("stroke-width",this.strokeWidth),e.className&&e.path.setAttribute("class",e.className))}}),o.namespace("Rickshaw.Graph.Renderer.ScatterPlot"),o.Graph.Renderer.ScatterPlot=o.Class.create(o.Graph.Renderer,{name:"scatterplot",defaults:function($super){return o.extend($super(),{unstack:!0,fill:!0,stroke:!1,padding:{top:.01,right:.01,bottom:.01,left:.01},dotSize:4})},initialize:function($super,e){$super(e)},render:function(e){e=e||{};var n=this.graph,t=e.series||n.series,r=e.vis||n.vis,s=this.dotSize;r.selectAll("*").remove(),t.forEach(function(t){if(!t.disabled){var i=t.opacity?t.opacity:1,e=r.selectAll("path").data(t.stack.filter(function(e){return null!==e.y})).enter().append("svg:circle").attr("cx",function(e){return n.x(e.x)}).attr("cy",function(e){return n.y(e.y)}).attr("r",function(e){return"r"in e?e.r:s}).attr("opacity",function(e){return"opacity"in e?e.opacity:i});t.className&&e.classed(t.className,!0),Array.prototype.forEach.call(e[0],function(e){e.setAttribute("fill",t.color)})}},this)}}),o.namespace("Rickshaw.Graph.Renderer.Multi"),o.Graph.Renderer.Multi=o.Class.create(o.Graph.Renderer,{name:"multi",initialize:function($super,e){$super(e)},defaults:function($super){return o.extend($super(),{unstack:!0,fill:!1,stroke:!0})},configure:function($super,e){e=e||{},$super(this.config=e)},domain:function($super){this.graph.stackData();var n=[],e=this._groups();return this._stack(e),e.forEach(function(e){var t=e.series.filter(function(e){return!e.disabled}).map(function(e){return e.stack});if(t.length){var i=null;i=e.renderer&&e.renderer.domain?e.renderer.domain(t):$super(t),n.push(i)}}),{x:[w.min(n.map(function(e){return e.x[0]})),w.max(n.map(function(e){return e.x[1]}))],y:[w.min(n.map(function(e){return e.y[0]})),w.max(n.map(function(e){return e.y[1]}))]}},_groups:function(){var r=this.graph,s={};r.series.forEach(function(e){if(!e.disabled){if(!s[e.renderer]){var t=document.createElementNS("http://www.w3.org/2000/svg","g");r.vis[0][0].appendChild(t);var i=r._renderers[e.renderer],n={};[this.defaults(),i.defaults(),this.config,this.graph].forEach(function(e){o.extend(n,e)}),i.configure(n),s[e.renderer]={renderer:i,series:[],vis:w.select(t)}}s[e.renderer].series.push(e)}},this);var i=[];return Object.keys(s).forEach(function(e){var t=s[e];i.push(t)}),i},_stack:function(e){return e.forEach(function(e){var t=e.series.filter(function(e){return!e.disabled}),i=t.map(function(e){return e.stack});if(!e.renderer.unstack){var n=w.layout.stack(),r=o.clone(n(i));t.forEach(function(e,t){e._stack=o.clone(r[t])})}},this),e},render:function(){this.graph.series.forEach(function(e){if(!e.renderer)throw new Error("Each series needs a renderer for graph 'multi' renderer")}),this.graph.vis.selectAll("*").remove();var e=this._groups();(e=this._stack(e)).forEach(function(e){var t=e.series.filter(function(e){return!e.disabled});t.active=function(){return t},e.renderer.render({series:t,vis:e.vis}),t.forEach(function(e){e.stack=e._stack||e.stack||e.data})})}}),o.namespace("Rickshaw.Graph.Renderer.LinePlot"),o.Graph.Renderer.LinePlot=o.Class.create(o.Graph.Renderer,{name:"lineplot",defaults:function($super){return o.extend($super(),{unstack:!0,fill:!1,stroke:!0,padding:{top:.01,right:.01,bottom:.01,left:.01},dotSize:3,strokeWidth:2})},seriesPathFactory:function(){var t=this.graph,e=w.svg.line().x(function(e){return t.x(e.x)}).y(function(e){return t.y(e.y)}).interpolate(this.graph.interpolation).tension(this.tension);return e.defined&&e.defined(function(e){return null!==e.y}),e},render:function(e){e=e||{};var i=this.graph,t=e.series||i.series,n=e.vis||i.vis,r=this.dotSize;n.selectAll("*").remove();var s=t.filter(function(e){return!e.disabled}).map(function(e){return e.stack}),a=n.selectAll("path").data(s).enter().append("svg:path").attr("d",this.seriesPathFactory()),h=0;t.forEach(function(e){e.disabled||(e.path=a[0][h++],this._styleSeries(e))},this),t.forEach(function(t){if(!t.disabled){var e=n.selectAll("x").data(t.stack.filter(function(e){return null!==e.y})).enter().append("svg:circle").attr("cx",function(e){return i.x(e.x)}).attr("cy",function(e){return i.y(e.y)}).attr("r",function(e){return"r"in e?e.r:r});Array.prototype.forEach.call(e[0],function(e){e&&(e.setAttribute("data-color",t.color),e.setAttribute("fill","white"),e.setAttribute("stroke",t.color),e.setAttribute("stroke-width",this.strokeWidth))}.bind(this))}},this)}}),o.namespace("Rickshaw.Graph.Smoother"),o.Graph.Smoother=o.Class.create({initialize:function(e){this.graph=e.graph,this.element=e.element,this.aggregationScale=1,this.build(),this.graph.stackData.hooks.data.push({name:"smoother",orderPosition:50,f:this.transformer.bind(this)})},build:function(){var i=this,e=jQuery;this.element&&e(function(){e(i.element).slider({min:1,max:100,slide:function(e,t){i.setScale(t.value)}})})},setScale:function(e){if(e<1)throw"scale out of range: "+e;this.aggregationScale=e,this.graph.update()},transformer:function(e){if(1==this.aggregationScale)return e;var s=[];return e.forEach(function(e){for(var t=[];e.length;){var i=0,n=0,r=e.splice(0,this.aggregationScale);r.forEach(function(e){i+=e.x/r.length,n+=e.y/r.length}),t.push({x:i,y:n})}s.push(t)}.bind(this)),s}}),o.namespace("Rickshaw.Graph.Socketio"),o.Graph.Socketio=o.Class.create(o.Graph.Ajax,{request:function(){var e=io.connect(this.dataURL),t=this;e.on("rickshaw",function(e){t.success(e)})}}),o.namespace("Rickshaw.Series"),o.Series=o.Class.create(Array,{initialize:function(e,t,i){i=i||{},this.palette=new o.Color.Palette(t),this.timeBase=void 0===i.timeBase?Math.floor((new Date).getTime()/1e3):i.timeBase;var n=void 0===i.timeInterval?1e3:i.timeInterval;this.setTimeInterval(n),e&&"object"==typeof e&&Array.isArray(e)&&e.forEach(function(e){this.addItem(e)},this)},addItem:function(t){if(void 0===t.name)throw"addItem() needs a name";t.color=t.color||this.palette.color(t.name),t.data=t.data||[],0===t.data.length&&this.length&&0<this.getIndex()?this[0].data.forEach(function(e){t.data.push({x:e.x,y:0})}):0===t.data.length&&t.data.push({x:this.timeBase-(this.timeInterval||0),y:0}),this.push(t),this.legend&&this.legend.addLine(this.itemByName(t.name))},addData:function(t,i){var n=this.getIndex();o.keys(t).forEach(function(e){this.itemByName(e)||this.addItem({name:e})},this),this.forEach(function(e){e.data.push({x:i||(n*this.timeInterval||1)+this.timeBase,y:t[e.name]||0})},this)},getIndex:function(){return this[0]&&this[0].data&&this[0].data.length?this[0].data.length:0},itemByName:function(e){for(var t=0;t<this.length;t++)if(this[t].name==e)return this[t]},setTimeInterval:function(e){this.timeInterval=e/1e3},setTimeBase:function(e){this.timeBase=e},dump:function(){var i={timeBase:this.timeBase,timeInterval:this.timeInterval,items:[]};return this.forEach(function(e){var t={color:e.color,name:e.name,data:[]};e.data.forEach(function(e){t.data.push({x:e.x,y:e.y})}),i.items.push(t)}),i},load:function(e){e.timeInterval&&(this.timeInterval=e.timeInterval),e.timeBase&&(this.timeBase=e.timeBase),e.items&&e.items.forEach(function(e){this.push(e),this.legend&&this.legend.addLine(this.itemByName(e.name))},this)}}),o.Series.zeroFill=function(e){o.Series.fill(e,0)},o.Series.fill=function(e,t){for(var i,n=0,r=e.map(function(e){return e.data});n<Math.max.apply(null,r.map(function(e){return e.length}));)i=Math.min.apply(null,r.filter(function(e){return e[n]}).map(function(e){return e[n].x})),r.forEach(function(e){e[n]&&e[n].x==i||e.splice(n,0,{x:i,y:t})}),n++},o.namespace("Rickshaw.Series.FixedDuration"),o.Series.FixedDuration=o.Class.create(o.Series,{initialize:function(e,t,i){if(void 0===(i=i||{}).timeInterval)throw new Error("FixedDuration series requires timeInterval");if(void 0===i.maxDataPoints)throw new Error("FixedDuration series requires maxDataPoints");if(this.palette=new o.Color.Palette(t),this.timeBase=void 0===i.timeBase?Math.floor((new Date).getTime()/1e3):i.timeBase,this.setTimeInterval(i.timeInterval),this[0]&&this[0].data&&this[0].data.length?(this.currentSize=this[0].data.length,this.currentIndex=this[0].data.length):(this.currentSize=0,this.currentIndex=0),this.maxDataPoints=i.maxDataPoints,e&&"object"==typeof e&&Array.isArray(e)&&(e.forEach(function(e){this.addItem(e)},this),this.currentSize+=1,this.currentIndex+=1),this.timeBase-=(this.maxDataPoints-this.currentSize)*this.timeInterval,void 0!==this.maxDataPoints&&this.currentSize<this.maxDataPoints)for(var n=this.maxDataPoints-this.currentSize-1;1<n;n--)this.currentSize+=1,this.currentIndex+=1,this.forEach(function(e){e.data.unshift({x:((n-1)*this.timeInterval||1)+this.timeBase,y:0,i:n})},this)},addData:function($super,e,t){if($super(e,t),this.currentSize+=1,this.currentIndex+=1,void 0!==this.maxDataPoints)for(;this.currentSize>this.maxDataPoints;)this.dropData()},dropData:function(){this.forEach(function(e){e.data.splice(0,1)}),this.currentSize-=1},getIndex:function(){return this.currentIndex}}),o});